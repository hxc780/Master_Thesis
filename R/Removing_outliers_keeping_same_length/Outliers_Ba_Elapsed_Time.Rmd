---
title: "Removing_outliers"
author: "Rebecca Holm"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

We are going to remove the outliers for all whales. We use the already plotted pointplots. 

```{r}
library(tidyverse)
library(ggplot2)
library(gridExtra)
library(reshape2)
library(dplyr)
```


# loding in the data
```{r}
merged_data_NEW <- read_csv("/Users/rebeccaholm/Desktop/MatÃ˜k/Speciale/R/merged_data_NEW.csv")
```



For the outliers that have another outlier as a neighbor we are going to do linear interpolation. If the first and last observation is an outlier I am going to do linear interpolation based on the two nearest "non-outlier" observations that are infront/behind the first/last observation. 

# ############################### 15 ####################################
```{r}
data_15 <-merged_data_NEW %>%
    filter(whale_index == "SMP_15") %>%
    select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_15$row_number <- seq(1, by=1, length.out=nrow(data_15))

subset(data_15, Ba_DIV_Ca > 0.000075)
subset(data_15, Ba_DIV_Ca < 0.0000125)
```


```{r}
data_15$Ba_DIV_Ca[1423:1453] <- data_15$Ba_DIV_Ca[1422] +
  ((1:31) / 32) * (data_15$Ba_DIV_Ca[1454] - data_15$Ba_DIV_Ca[1422])

#data_15 <- data_15[-c(2100:2725),]
data_15 <- data_15[-2725,]
data_15 <- data_15[-1,]
data_15$row_number <- seq(1, by=1, length.out=nrow(data_15))
```

I do a point plot, to see if I have captured all the outliers. I have have not I go back and add more to the above code until I am satisfied.

```{r}
data_15####data_15)/10000, length.out=nrow(data_15))

ggplot(data_15, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```
I then go and fit the trend, remove the trend, divide by sd and then save the dataset, such that it can be ready to fit in the FitModel script.

```{r}
trend_15 <- loess(data_15$Ba_DIV_Ca ~ data_15$Elapsed_DIV_Time)
trend1_15 <- data.frame(trend_15 = trend_15$fitted, Elapsed_DIV_Time = data_15$Elapsed_DIV_Time)

ggplot(data_15, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_15, aes(y= trend_15), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

When I see that the trend looks fine I create my last dataset:
```{r}
# subtracting the trend
data_15$no_trend <- data_15$Ba_DIV_Ca - trend1_15$trend_15

# dividing the new timeseries with the sd(timeserie)
data_15$nt_sd <- data_15$no_trend/sd(data_15$no_trend)

# see if they oscillate around 0
ggplot(data_15, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_15",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_15, "data_15.csv", row.names = FALSE)
```


# ############################### 18 ####################################
```{r}
data_18 <-merged_data_NEW %>%
  filter(whale_index == "SMP_18") %>%
  select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_18$row_number <- seq(1, by=1, length.out=nrow(data_18))

subset(data_18, Ba_DIV_Ca > 0.002)
subset(data_18, Ba_DIV_Ca < 0.00)
```


```{r}
data_18 <- data_18[-1508,]
data_18 <- data_18[-3,]
data_18 <- data_18[-2,]
data_18 <- data_18[-1,]

data_18$row_number <- seq(1, by=1, length.out=nrow(data_18))
```


```{r}
data_18####data_18)/10000, length.out=nrow(data_18))

ggplot(data_18, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_18"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```


```{r}
trend_18 <- loess(data_18$Ba_DIV_Ca ~ data_18$Elapsed_DIV_Time)
trend1_18 <- data.frame(trend_18 = trend_18$fitted, Elapsed_DIV_Time = data_18$Elapsed_DIV_Time)

ggplot(data_18, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_18, aes(y= trend_18), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_18",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

```{r}
# subtracting the trend
data_18$no_trend <- data_18$Ba_DIV_Ca - trend1_18$trend_18

# dividing the new timeseries with the sd(timeserie)
data_18$nt_sd <- data_18$no_trend/sd(data_18$no_trend)

# see if they oscillate around 0
ggplot(data_18, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_18",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_18, "data_18.csv", row.names = FALSE)
```

# ############################### 21 ####################################
```{r}
data_21 <-merged_data_NEW %>%
  filter(whale_index == "SMP_21") %>%
  select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_21$row_number <- seq(1, by=1, length.out=nrow(data_21))

subset(data_21, Ba_DIV_Ca > 0.00004)
subset(data_21, Ba_DIV_Ca < 0.000025)

```


```{r}
data_21$Ba_DIV_Ca[101] <- (data_21$Ba_DIV_Ca[100] + data_21$Ba_DIV_Ca[102]) / 2

data_21$Ba_DIV_Ca[106:109] <- data_21$Ba_DIV_Ca[105] +
  ((1:4) / 5) * (data_21$Ba_DIV_Ca[110] - data_21$Ba_DIV_Ca[105])

data_21$Ba_DIV_Ca[170] <- (data_21$Ba_DIV_Ca[171] + data_21$Ba_DIV_Ca[169]) / 2
data_21$Ba_DIV_Ca[337] <- (data_21$Ba_DIV_Ca[336] + data_21$Ba_DIV_Ca[338]) / 2

data_21$Ba_DIV_Ca[499:500] <- data_21$Ba_DIV_Ca[498] +
  ((1:2) / 3) * (data_21$Ba_DIV_Ca[501] - data_21$Ba_DIV_Ca[498])

data_21$Ba_DIV_Ca[649] <- (data_21$Ba_DIV_Ca[650] + data_21$Ba_DIV_Ca[648]) / 2

data_21$Ba_DIV_Ca[829:850] <- data_21$Ba_DIV_Ca[828] +
  ((1:22) / 23) * (data_21$Ba_DIV_Ca[851] - data_21$Ba_DIV_Ca[828])


data_21 <- data_21[-c(1248:1250),]
data_21 <- data_21[-c(1:2),]

data_21$row_number <- seq(1, by=1, length.out=nrow(data_21))
```


```{r}
data_21####data_21)/10000, length.out=nrow(data_21))

ggplot(data_21, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_21"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```

```{r}
trend_21 <- loess(data_21$Ba_DIV_Ca ~ data_21$Elapsed_DIV_Time)
trend1_21 <- data.frame(trend_21 = trend_21$fitted, Elapsed_DIV_Time = data_21$Elapsed_DIV_Time)

ggplot(data_21, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_21, aes(y= trend_21), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_21",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

```{r}
# subtracting the trend
data_21$no_trend <- data_21$Ba_DIV_Ca - trend1_21$trend_21

# dividing the new timeseries with the sd(timeserie)
data_21$nt_sd <- data_21$no_trend/sd(data_21$no_trend)

# see if they oscillate around 0
ggplot(data_21, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_21",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_21, "data_21.csv", row.names = FALSE)
```

# ############################### 26 ####################################
```{r}
data_26 <-merged_data_NEW %>%
  filter(whale_index == "SMP_26") %>%
  select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_26$row_number <- seq(1, by=1, length.out=nrow(data_26))

subset(data_26, Ba_DIV_Ca > 0.000075)
subset(data_26, Ba_DIV_Ca < 0.00)
```

```{r}
data_26 <- data_26[-c(1730:1731),]
data_26 <- data_26[-c(1:3),]

data_26$row_number <- seq(1, by=1, length.out=nrow(data_26))
```


```{r}
data_26####data_26)/10000, length.out=nrow(data_26))

ggplot(data_26, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_26"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```

```{r}
trend_26 <- loess(data_26$Ba_DIV_Ca ~ data_26$Elapsed_DIV_Time)
trend1_26 <- data.frame(trend_26 = trend_26$fitted, Elapsed_DIV_Time = data_26$Elapsed_DIV_Time)

ggplot(data_26, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_26, aes(y= trend_26), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_26",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

```{r}
# subtracting the trend
data_26$no_trend <- data_26$Ba_DIV_Ca - trend1_26$trend_26

# dividing the new timeseries with the sd(timeserie)
data_26$nt_sd <- data_26$no_trend/sd(data_26$no_trend)

# see if they oscillate around 0
ggplot(data_26, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_26",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_26, "data_26.csv", row.names = FALSE)
```

# ############################### 99 ####################################
```{r}
data_99 <-merged_data_NEW %>%
  filter(whale_index == "SMP_99") %>%
  select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_99$row_number <- seq(1, by=1, length.out=nrow(data_99))

subset(data_99, Ba_DIV_Ca > 0.000025)
subset(data_99, Ba_DIV_Ca < 0.0003)
```

```{r}
data_99$Ba_DIV_Ca[1430] <- (data_99$Ba_DIV_Ca[1429] + data_99$Ba_DIV_Ca[1431]) / 2

data_99 <- data_99[-c(1435:1437),]
data_99 <- data_99[-c(1:9),]

data_99$row_number <- seq(1, by=1, length.out=nrow(data_99))
```


```{r}
data_99####data_99)/10000, length.out=nrow(data_99))

ggplot(data_99, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_99"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```

```{r}
trend_99 <- loess(data_99$Ba_DIV_Ca ~ data_99$Elapsed_DIV_Time)
trend1_99 <- data.frame(trend_99 = trend_99$fitted, Elapsed_DIV_Time = data_99$Elapsed_DIV_Time)

ggplot(data_99, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_99, aes(y= trend_99), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_99",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

```{r}
# subtracting the trend
data_99$no_trend <- data_99$Ba_DIV_Ca - trend1_99$trend_99

# dividing the new timeseries with the sd(timeserie)
data_99$nt_sd <- data_99$no_trend/sd(data_99$no_trend)

# see if they oscillate around 0
ggplot(data_99, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_99",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_99, "data_99.csv", row.names = FALSE)
```

# ############################### 100 ####################################
```{r}
data_100 <-merged_data_NEW %>%
  filter(whale_index == "SMP_100") %>%
  select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_100$row_number <- seq(1, by=1, length.out=nrow(data_100))

subset(data_100, Ba_DIV_Ca > 0.0000075)
subset(data_100, Ba_DIV_Ca < 0.0000025)
```

```{r}
data_100$Ba_DIV_Ca[7] <- (data_100$Ba_DIV_Ca[8] + data_100$Ba_DIV_Ca[6]) / 2
data_100$Ba_DIV_Ca[12] <- (data_100$Ba_DIV_Ca[13] + data_100$Ba_DIV_Ca[11]) / 2
data_100$Ba_DIV_Ca[295] <- (data_100$Ba_DIV_Ca[296] + data_100$Ba_DIV_Ca[294]) / 2
data_100$Ba_DIV_Ca[380] <- (data_100$Ba_DIV_Ca[381] + data_100$Ba_DIV_Ca[379]) / 2
data_100$Ba_DIV_Ca[752] <- (data_100$Ba_DIV_Ca[751] + data_100$Ba_DIV_Ca[753]) / 2
data_100$Ba_DIV_Ca[803] <- (data_100$Ba_DIV_Ca[802] + data_100$Ba_DIV_Ca[804]) / 2


data_100 <- data_100[-c(937:938),]
data_100 <- data_100[-1,]
data_100$row_number <- seq(1, by=1, length.out=nrow(data_100))
```


```{r}
data_100####data_100)/10000, length.out=nrow(data_100))

ggplot(data_100, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_100"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```

```{r}
trend_100 <- loess(data_100$Ba_DIV_Ca ~ data_100$Elapsed_DIV_Time)
trend1_100 <- data.frame(trend_100 = trend_100$fitted, Elapsed_DIV_Time = data_100$Elapsed_DIV_Time)

ggplot(data_100, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_100, aes(y= trend_100), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_100",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

```{r}
# subtracting the trend
data_100$no_trend <- data_100$Ba_DIV_Ca - trend1_100$trend_100

# dividing the new timeseries with the sd(timeserie)
data_100$nt_sd <- data_100$no_trend/sd(data_100$no_trend)

# see if they oscillate around 0
ggplot(data_100, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_100",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_100, "data_100.csv", row.names = FALSE)
```

# ############################### 102 ####################################
```{r}
data_102 <-merged_data_NEW %>%
  filter(whale_index == "SMP_102") %>%
  select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_102$row_number <- seq(1, by=1, length.out=nrow(data_102))

subset(data_102, Ba_DIV_Ca > 0.002)
subset(data_102, Ba_DIV_Ca < 0.00)
```

```{r}
data_102 <- data_102[-c(1541:1543),]
data_102 <- data_102[-c(1:3),]


data_102$row_number <- seq(1, by=1, length.out=nrow(data_102))
```


```{r}
data_102####data_102)/10000, length.out=nrow(data_102))

ggplot(data_102, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_102"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```

```{r}
trend_102 <- loess(data_102$Ba_DIV_Ca ~ data_102$Elapsed_DIV_Time)
trend1_102 <- data.frame(trend_102 = trend_102$fitted, Elapsed_DIV_Time = data_102$Elapsed_DIV_Time)

ggplot(data_102, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_102, aes(y= trend_102), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_102",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

```{r}
# subtracting the trend
data_102$no_trend <- data_102$Ba_DIV_Ca - trend1_102$trend_102

# dividing the new timeseries with the sd(timeserie)
data_102$nt_sd <- data_102$no_trend/sd(data_102$no_trend)

# see if they oscillate around 0
ggplot(data_102, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_102",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_102, "data_102.csv", row.names = FALSE)
```


# ############################### 112 ####################################
```{r}
data_112 <-merged_data_NEW %>%
  filter(whale_index == "SMP_112") %>%
  select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_112$row_number <- seq(1, by=1, length.out=nrow(data_112))

subset(data_112, Ba_DIV_Ca > 0.000025)
subset(data_112, Ba_DIV_Ca < 0.00)

```

```{r}
data_112$Ba_DIV_Ca[372] <- (data_112$Ba_DIV_Ca[371] + data_112$Ba_DIV_Ca[373]) / 2
data_112$Ba_DIV_Ca[1273] <- (data_112$Ba_DIV_Ca[1272] + data_112$Ba_DIV_Ca[1274]) / 2
data_112$Ba_DIV_Ca[1409] <- (data_112$Ba_DIV_Ca[1408] + data_112$Ba_DIV_Ca[1410]) / 2
data_112 <- data_112[-1574,]
data_112 <- data_112[-1573,]
data_112 <- data_112[-c(1:3),]

data_112$row_number <- seq(1, by=1, length.out=nrow(data_112))
```


```{r}
data_112####data_112)/10000, length.out=nrow(data_112))

ggplot(data_112, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_112"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```

```{r}
trend_112 <- loess(data_112$Ba_DIV_Ca ~ data_112$Elapsed_DIV_Time)
trend1_112 <- data.frame(trend_112 = trend_112$fitted, Elapsed_DIV_Time = data_112$Elapsed_DIV_Time)

ggplot(data_112, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_112, aes(y= trend_112), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_112",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

```{r}
# subtracting the trend
data_112$no_trend <- data_112$Ba_DIV_Ca - trend1_112$trend_112

# dividing the new timeseries with the sd(timeserie)
data_112$nt_sd <- data_112$no_trend/sd(data_112$no_trend)

# see if they oscillate around 0
ggplot(data_112, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_112",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_112, "data_112.csv", row.names = FALSE)
```


# ############################### 121 ####################################
```{r}
data_121 <-merged_data_NEW %>%
  filter(whale_index == "SMP_121") %>%
  select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_121$row_number <- seq(1, by=1, length.out=nrow(data_121))

subset(data_121, Ba_DIV_Ca > 0.002)
subset(data_121, Ba_DIV_Ca < 0.00)
```

```{r}
data_121 <- data_121[-1257,]
data_121 <- data_121[-1256,]
data_121 <- data_121[-2,]
data_121 <- data_121[-1,]

data_121$row_number <- seq(1, by=1, length.out=nrow(data_121))
```


```{r}
data_121####data_121)/10000, length.out=nrow(data_121))

ggplot(data_121, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_121"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```

```{r}
trend_121 <- loess(data_121$Ba_DIV_Ca ~ data_121$Elapsed_DIV_Time)
trend1_121 <- data.frame(trend_121 = trend_121$fitted, Elapsed_DIV_Time = data_121$Elapsed_DIV_Time)

ggplot(data_121, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_121, aes(y= trend_121), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_121",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

```{r}
# subtracting the trend
data_121$no_trend <- data_121$Ba_DIV_Ca - trend1_121$trend_121

# dividing the new timeseries with the sd(timeserie)
data_121$nt_sd <- data_121$no_trend/sd(data_121$no_trend)

# see if they oscillate around 0
ggplot(data_121, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_121",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_121, "data_121.csv", row.names = FALSE)
```


# ############################### 127 ####################################
```{r}
data_127 <-merged_data_NEW %>%
  filter(whale_index == "SMP_127") %>%
  select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_127$row_number <- seq(1, by=1, length.out=nrow(data_127))

subset(data_127, Ba_DIV_Ca > 0.00005)
subset(data_127, Ba_DIV_Ca < 0)
```

```{r}
data_127$Ba_DIV_Ca[435:441] <- data_127$Ba_DIV_Ca[434] + 
  ((1:7) / 8) * (data_127$Ba_DIV_Ca[442] - data_127$Ba_DIV_Ca[434])

data_127$Ba_DIV_Ca[1895]    <- (data_127$Ba_DIV_Ca[1894] + data_127$Ba_DIV_Ca[1896]) / 2
data_127$Ba_DIV_Ca[1745]    <- (data_127$Ba_DIV_Ca[1744] + data_127$Ba_DIV_Ca[1746]) / 2
data_127$Ba_DIV_Ca[1694]    <- (data_127$Ba_DIV_Ca[1695] + data_127$Ba_DIV_Ca[1693]) / 2

data_127$Ba_DIV_Ca[1495:1505] <- data_127$Ba_DIV_Ca[1494] + 
  ((1:11) / 12) * (data_127$Ba_DIV_Ca[1506] - data_127$Ba_DIV_Ca[1494])

data_127 <- data_127[-1949,]
data_127 <- data_127[-1,]
```


```{r}
data_127####data_127)/10000, length.out=nrow(data_127))

ggplot(data_127, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_127"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```

```{r}
trend_127 <- loess(data_127$Ba_DIV_Ca ~ data_127$Elapsed_DIV_Time)
trend1_127 <- data.frame(trend_127 = trend_127$fitted, Elapsed_DIV_Time = data_127$Elapsed_DIV_Time)

ggplot(data_127, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_127, aes(y= trend_127), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_127",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

```{r}
# subtracting the trend
data_127$no_trend <- data_127$Ba_DIV_Ca - trend1_127$trend_127

# dividing the new timeseries with the sd(timeserie)
data_127$nt_sd <- data_127$no_trend/sd(data_127$no_trend)

# see if they oscillate around 0
ggplot(data_127, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_127",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_127, "data_127.csv", row.names = FALSE)
```

# ############################### 133 ####################################
```{r}
data_133 <-merged_data_NEW %>%
  filter(whale_index == "SMP_133") %>%
  select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_133$row_number <- seq(1, by=1, length.out=nrow(data_133))

subset(data_133, Ba_DIV_Ca > 0.00005)
subset(data_133, Ba_DIV_Ca < 0.00)
```

```{r}
data_133$Ba_DIV_Ca[1223:1225] <- data_133$Ba_DIV_Ca[1222] + 
  ((1:3) / 4) * (data_133$Ba_DIV_Ca[1226] - data_133$Ba_DIV_Ca[1222])

data_133 <- data_133[-1,]

data_133$row_number <- seq(1, by=1, length.out=nrow(data_133))
```


```{r}
data_133####data_133)/10000, length.out=nrow(data_133))

ggplot(data_133, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_133"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```

```{r}
trend_133 <- loess(data_133$Ba_DIV_Ca ~ data_133$Elapsed_DIV_Time)
trend1_133 <- data.frame(trend_133 = trend_133$fitted, Elapsed_DIV_Time = data_133$Elapsed_DIV_Time)

ggplot(data_133, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_133, aes(y= trend_133), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_133",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

```{r}
# subtracting the trend
data_133$no_trend <- data_133$Ba_DIV_Ca - trend1_133$trend_133

# dividing the new timeseries with the sd(timeserie)
data_133$nt_sd <- data_133$no_trend/sd(data_133$no_trend)

# see if they oscillate around 0
ggplot(data_133, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_133",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_133, "data_133.csv", row.names = FALSE)
```


# ############################### 135 ####################################
```{r}
data_135 <-merged_data_NEW %>%
  filter(whale_index == "SMP_135") %>%
  select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_135$row_number <- seq(1, by=1, length.out=nrow(data_135))

subset(data_135, Ba_DIV_Ca < 0.000026, Ba_DIV_Ca > 0.0000125)
subset(data_135, Ba_DIV_Ca < 0.00, )
```

```{r}
data_135 <- data_135[-c(1907:1911),]
data_135 <- data_135[-c(1:3),]

data_135$row_number <- seq(1, by=1, length.out=nrow(data_135))
```


```{r}
data_135####data_135)/10000, length.out=nrow(data_135))

ggplot(data_135, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_135"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```

```{r}
trend_135 <- loess(data_135$Ba_DIV_Ca ~ data_135$Elapsed_DIV_Time)
trend1_135 <- data.frame(trend_135 = trend_135$fitted, Elapsed_DIV_Time = data_135$Elapsed_DIV_Time)

ggplot(data_135, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_135, aes(y= trend_135), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_135",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

```{r}
# subtracting the trend
data_135$no_trend <- data_135$Ba_DIV_Ca - trend1_135$trend_135

# dividing the new timeseries with the sd(timeserie)
data_135$nt_sd <- data_135$no_trend/sd(data_135$no_trend)

# see if they oscillate around 0
ggplot(data_135, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_135",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_135, "data_135.csv", row.names = FALSE)
```

# ############################### 137 ####################################
```{r}
data_137 <-merged_data_NEW %>%
  filter(whale_index == "SMP_137") %>%
  select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_137$row_number <- seq(1, by=1, length.out=nrow(data_137))

subset(data_137, Ba_DIV_Ca > 0.002)
subset(data_137, Ba_DIV_Ca < 0.00)
```

```{r}
data_137$Ba_DIV_Ca[1502:1509] <- data_137$Ba_DIV_Ca[1501] + 
  ((1:8) / 9) * (data_137$Ba_DIV_Ca[1510] - data_137$Ba_DIV_Ca[1501])

data_137 <- data_137[-1640,]
data_137 <- data_137[-1639,]
data_137 <- data_137[-c(1:3),]

data_137$row_number <- seq(1, by=1, length.out=nrow(data_137))
```


```{r}
data_137####data_137)/10000, length.out=nrow(data_137))

ggplot(data_137, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_137"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```

```{r}
trend_137 <- loess(data_137$Ba_DIV_Ca ~ data_137$Elapsed_DIV_Time)
trend1_137 <- data.frame(trend_137 = trend_137$fitted, Elapsed_DIV_Time = data_137$Elapsed_DIV_Time)

ggplot(data_137, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_137, aes(y= trend_137), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_137",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

```{r}
# subtracting the trend
data_137$no_trend <- data_137$Ba_DIV_Ca - trend1_137$trend_137

# dividing the new timeseries with the sd(timeserie)
data_137$nt_sd <- data_137$no_trend/sd(data_137$no_trend)

# see if they oscillate around 0
ggplot(data_137, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_137",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_137, "data_137.csv", row.names = FALSE)
```

# ############################### 146 ####################################
```{r}
data_146 <-merged_data_NEW %>%
  filter(whale_index == "SMP_146") %>%
  select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_146$row_number <- seq(1, by=1, length.out=nrow(data_146))

subset(data_146, Ba_DIV_Ca > 0.00125)
subset(data_146, Ba_DIV_Ca < 0.0004)
```

```{r}
data_146$Ba_DIV_Ca[450]    <- (data_146$Ba_DIV_Ca[451] + data_146$Ba_DIV_Ca[449]) / 2

data_146 <- data_146[-1528,]
data_146 <- data_146[-4,]
data_146 <- data_146[-3,]
data_146 <- data_146[-2,]
data_146 <- data_146[-1,]


data_146$row_number <- seq(1, by=1, length.out=nrow(data_146))
```


```{r}
data_146####data_146)/10000, length.out=nrow(data_146))

ggplot(data_146, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_146"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```

```{r}
trend_146 <- loess(data_146$Ba_DIV_Ca ~ data_146$Elapsed_DIV_Time)
trend1_146 <- data.frame(trend_146 = trend_146$fitted, Elapsed_DIV_Time = data_146$Elapsed_DIV_Time)

ggplot(data_146, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_146, aes(y= trend_146), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_146",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

```{r}
# subtracting the trend
data_146$no_trend <- data_146$Ba_DIV_Ca - trend1_146$trend_146

# dividing the new timeseries with the sd(timeserie)
data_146$nt_sd <- data_146$no_trend/sd(data_146$no_trend)

# see if they oscillate around 0
ggplot(data_146, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_146",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_146, "data_146.csv", row.names = FALSE)
```

# ############################### 157 ####################################
```{r}
data_157 <-merged_data_NEW %>%
  filter(whale_index == "SMP_157") %>%
  select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_157$row_number <- seq(1, by=1, length.out=nrow(data_157))

subset(data_157, Ba_DIV_Ca > 0.00006)
subset(data_157, Ba_DIV_Ca < 0.00)
```

```{r}
data_157$Ba_DIV_Ca[523] <- (data_157$Ba_DIV_Ca[524] + data_157$Ba_DIV_Ca[522]) / 2

data_157 <- data_157[-c(1255:1257),]
data_157 <- data_157[-1,]

data_157$row_number <- seq(1, by=1, length.out=nrow(data_157))
```


```{r}
data_157####data_157)/10000, length.out=nrow(data_157))

ggplot(data_157, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_157"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```

```{r}
trend_157 <- loess(data_157$Ba_DIV_Ca ~ data_157$Elapsed_DIV_Time)
trend1_157 <- data.frame(trend_157 = trend_157$fitted, Elapsed_DIV_Time = data_157$Elapsed_DIV_Time)

ggplot(data_157, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_157, aes(y= trend_157), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_157",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

```{r}
# subtracting the trend
data_157$no_trend <- data_157$Ba_DIV_Ca - trend1_157$trend_157

# dividing the new timeseries with the sd(timeserie)
data_157$nt_sd <- data_157$no_trend/sd(data_157$no_trend)

# see if they oscillate around 0
ggplot(data_157, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_157",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_157, "data_157.csv", row.names = FALSE)
```

# ############################### 164 ####################################
```{r}
data_164 <-merged_data_NEW %>%
  filter(whale_index == "SMP_164") %>%
  select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_164$row_number <- seq(1, by=1, length.out=nrow(data_164))

subset(data_164, Ba_DIV_Ca > 0.0004)
subset(data_164, Ba_DIV_Ca < 0.00)
```

```{r}
data_164$Ba_DIV_Ca[199] <- (data_164$Ba_DIV_Ca[200] + data_164$Ba_DIV_Ca[198]) / 2
data_164$Ba_DIV_Ca[31] <- (data_164$Ba_DIV_Ca[32] + data_164$Ba_DIV_Ca[30]) / 2
data_164$Ba_DIV_Ca[46] <- (data_164$Ba_DIV_Ca[45] + data_164$Ba_DIV_Ca[47]) / 2

data_164$Ba_DIV_Ca[23:26] <- data_164$Ba_DIV_Ca[22] + 
  ((1:4) / 5) * (data_164$Ba_DIV_Ca[27] - data_164$Ba_DIV_Ca[22])

data_164$Ba_DIV_Ca[65:67] <- data_164$Ba_DIV_Ca[64] + 
  ((1:3) / 4) * (data_164$Ba_DIV_Ca[68] - data_164$Ba_DIV_Ca[64])

data_164$Ba_DIV_Ca[728:729] <- data_164$Ba_DIV_Ca[727] + 
  ((1:2) / 3) * (data_164$Ba_DIV_Ca[730] - data_164$Ba_DIV_Ca[727])

data_164 <- data_164[-c(1236:1238),]
data_164 <- data_164[-c(1:7),]


data_164$row_number <- seq(1, by=1, length.out=nrow(data_164))
```


```{r}
data_164####data_164)/10000, length.out=nrow(data_164))

ggplot(data_164, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_164"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```

```{r}
trend_164 <- loess(data_164$Ba_DIV_Ca ~ data_164$Elapsed_DIV_Time)
trend1_164 <- data.frame(trend_164 = trend_164$fitted, Elapsed_DIV_Time = data_164$Elapsed_DIV_Time)

ggplot(data_164, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_164, aes(y= trend_164), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_164",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

```{r}
# subtracting the trend
data_164$no_trend <- data_164$Ba_DIV_Ca - trend1_164$trend_164

# dividing the new timeseries with the sd(timeserie)
data_164$nt_sd <- data_164$no_trend/sd(data_164$no_trend)

# see if they oscillate around 0
ggplot(data_164, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_164",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_164, "data_164.csv", row.names = FALSE)
```

# ############################### 169 ####################################
```{r}
data_169 <-merged_data_NEW %>%
  filter(whale_index == "SMP_169") %>%
  select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_169$row_number <- seq(1, by=1, length.out=nrow(data_169))

subset(data_169, Ba_DIV_Ca > 0.0023)
subset(data_169, Ba_DIV_Ca < 0.0005)
```

```{r}
data_169 <- data_169[-1527,]
data_169 <- data_169[-1526,]
data_169 <- data_169[-1525,]
data_169 <- data_169[-2,]
data_169 <- data_169[-1,]

data_169$row_number <- seq(1, by=1, length.out=nrow(data_169))
```


```{r}
data_169####data_169)/10000, length.out=nrow(data_169))

ggplot(data_169, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_169"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```

```{r}
trend_169 <- loess(data_169$Ba_DIV_Ca ~ data_169$Elapsed_DIV_Time)
trend1_169 <- data.frame(trend_169 = trend_169$fitted, Elapsed_DIV_Time = data_169$Elapsed_DIV_Time)

ggplot(data_169, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_169, aes(y= trend_169), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_169",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

```{r}
# subtracting the trend
data_169$no_trend <- data_169$Ba_DIV_Ca - trend1_169$trend_169

# dividing the new timeseries with the sd(timeserie)
data_169$nt_sd <- data_169$no_trend/sd(data_169$no_trend)

# see if they oscillate around 0
ggplot(data_169, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_169",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_169, "data_169.csv", row.names = FALSE)
```

# ############################### 186 ####################################
```{r}
data_186 <-merged_data_NEW %>%
  filter(whale_index == "SMP_186") %>%
  select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_186$row_number <- seq(1, by=1, length.out=nrow(data_186))

subset(data_186, Ba_DIV_Ca > 0.00009)
subset(data_186, Ba_DIV_Ca < 0.00)
```

```{r}
data_186$Ba_DIV_Ca[1892] <- (data_186$Ba_DIV_Ca[1891] + data_186$Ba_DIV_Ca[1893]) / 2

data_186 <- data_186[-c(2064:2066),]
data_186 <- data_186[-3,]
data_186 <- data_186[-2,]
data_186 <- data_186[-1,]

data_186$row_number <- seq(1, by=1, length.out=nrow(data_186))
```


```{r}
data_186####data_186)/10000, length.out=nrow(data_186))

ggplot(data_186, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_186"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```

```{r}
trend_186 <- loess(data_186$Ba_DIV_Ca ~ data_186$Elapsed_DIV_Time)
trend1_186 <- data.frame(trend_186 = trend_186$fitted, Elapsed_DIV_Time = data_186$Elapsed_DIV_Time)

ggplot(data_186, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_186, aes(y= trend_186), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_186",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

```{r}
# subtracting the trend
data_186$no_trend <- data_186$Ba_DIV_Ca - trend1_186$trend_186

# dividing the new timeseries with the sd(timeserie)
data_186$nt_sd <- data_186$no_trend/sd(data_186$no_trend)

# see if they oscillate around 0
ggplot(data_186, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_186",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_186, "data_186.csv", row.names = FALSE)
```

# ############################### 188 ####################################
```{r}
data_188 <-merged_data_NEW %>%
  filter(whale_index == "SMP_188") %>%
  select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_188$row_number <- seq(1, by=1, length.out=nrow(data_188))

subset(data_188, Ba_DIV_Ca > 0.00009)
subset(data_188, Ba_DIV_Ca < 0.00)
```

```{r}
data_188$Ba_DIV_Ca[237:240] <- data_188$Ba_DIV_Ca[235] + 
  ((1:4) / 5) * (data_188$Ba_DIV_Ca[241] - data_188$Ba_DIV_Ca[235])

data_188$Ba_DIV_Ca[400:403] <- data_188$Ba_DIV_Ca[399] + 
  ((1:4) / 5) * (data_188$Ba_DIV_Ca[404] - data_188$Ba_DIV_Ca[399])

data_188 <- data_188[-c(1528:1530),]
data_188 <- data_188[-c(1:3),]

data_188$row_number <- seq(1, by=1, length.out=nrow(data_188))
```


```{r}
data_188####data_188)/10000, length.out=nrow(data_188))

ggplot(data_188, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_188"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```

```{r}
trend_188 <- loess(data_188$Ba_DIV_Ca ~ data_188$Elapsed_DIV_Time)
trend1_188 <- data.frame(trend_188 = trend_188$fitted, Elapsed_DIV_Time = data_188$Elapsed_DIV_Time)

ggplot(data_188, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_188, aes(y= trend_188), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_188",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

```{r}
# subtracting the trend
data_188$no_trend <- data_188$Ba_DIV_Ca - trend1_188$trend_188

# dividing the new timeseries with the sd(timeserie)
data_188$nt_sd <- data_188$no_trend/sd(data_188$no_trend)

# see if they oscillate around 0
ggplot(data_188, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_188",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_188, "data_188.csv", row.names = FALSE)
```

# ############################### 215 ####################################
```{r}
data_215 <-merged_data_NEW %>%
  filter(whale_index == "SMP_215") %>%
  select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_215$row_number <- seq(1, by=1, length.out=nrow(data_215))

subset(data_215, Ba_DIV_Ca > 0.00005)
subset(data_215, Ba_DIV_Ca < 0.00)
```

```{r}
data_215$Ba_DIV_Ca[78] <- (data_215$Ba_DIV_Ca[77] + data_215$Ba_DIV_Ca[79]) / 2

data_215 <- data_215[-c(1539:1545),]
data_215 <- data_215[-3,]
data_215 <- data_215[-2,]
data_215 <- data_215[-1,]

data_215$row_number <- seq(1, by=1, length.out=nrow(data_215))
```


```{r}
data_215####data_215)/10000, length.out=nrow(data_215))

ggplot(data_215, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_215"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```

```{r}
trend_215 <- loess(data_215$Ba_DIV_Ca ~ data_215$Elapsed_DIV_Time)
trend1_215 <- data.frame(trend_215 = trend_215$fitted, Elapsed_DIV_Time = data_215$Elapsed_DIV_Time)

ggplot(data_215, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_215, aes(y= trend_215), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_215",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

```{r}
# subtracting the trend
data_215$no_trend <- data_215$Ba_DIV_Ca - trend1_215$trend_215

# dividing the new timeseries with the sd(timeserie)
data_215$nt_sd <- data_215$no_trend/sd(data_215$no_trend)

# see if they oscillate around 0
ggplot(data_215, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_215",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_215, "data_215.csv", row.names = FALSE)
```

# ############################### 210101 ####################################
```{r}
data_210101 <-merged_data_NEW %>%
  filter(whale_index == "SMP_210101") %>%
  select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_210101$row_number <- seq(1, by=1, length.out=nrow(data_210101))

subset(data_210101, Ba_DIV_Ca > 0.00002)
subset(data_210101, Ba_DIV_Ca < 0.00025)
```

```{r}
data_210101$Ba_DIV_Ca[535] <- (data_210101$Ba_DIV_Ca[534] + data_210101$Ba_DIV_Ca[536]) / 2
data_210101$Ba_DIV_Ca[399] <- (data_210101$Ba_DIV_Ca[400] + data_210101$Ba_DIV_Ca[398]) / 2
data_210101$Ba_DIV_Ca[411] <- (data_210101$Ba_DIV_Ca[410] + data_210101$Ba_DIV_Ca[411]) / 2

data_210101 <- data_210101[-1568,]
data_210101 <- data_210101[-1567,]
data_210101 <- data_210101[-1566,]
data_210101 <- data_210101[-2,]
data_210101 <- data_210101[-1,]

data_210101$row_number <- seq(1, by=1, length.out=nrow(data_210101))
```


```{r}
data_210101####data_210101)/10000, length.out=nrow(data_210101))

ggplot(data_210101, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210101"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```

```{r}
trend_210101 <- loess(data_210101$Ba_DIV_Ca ~ data_210101$Elapsed_DIV_Time)
trend1_210101 <- data.frame(trend_210101 = trend_210101$fitted, Elapsed_DIV_Time = data_210101$Elapsed_DIV_Time)

ggplot(data_210101, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_210101, aes(y= trend_210101), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210101",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

```{r}
# subtracting the trend
data_210101$no_trend <- data_210101$Ba_DIV_Ca - trend1_210101$trend_210101

# dividing the new timeseries with the sd(timeserie)
data_210101$nt_sd <- data_210101$no_trend/sd(data_210101$no_trend)

# see if they oscillate around 0
ggplot(data_210101, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210101",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_210101, "data_210101.csv", row.names = FALSE)
```

# ############################### 210106 ####################################
```{r}
data_210106 <-merged_data_NEW %>%
  filter(whale_index == "SMP_210106") %>%
  select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_210106$row_number <- seq(1, by=1, length.out=nrow(data_210106))

subset(data_210106, Ba_DIV_Ca > 0.00004)
subset(data_210106, Ba_DIV_Ca < 0.00)
```

```{r}
data_210106$Ba_DIV_Ca[147:152] <- data_210106$Ba_DIV_Ca[146] + 
  ((1:6) / 7) * (data_210106$Ba_DIV_Ca[153] - data_210106$Ba_DIV_Ca[146])

data_210106$Ba_DIV_Ca[382] <- (data_210106$Ba_DIV_Ca[381] + data_210106$Ba_DIV_Ca[383]) / 2


data_210106 <- data_210106[-c(1458:1460),]
data_210106 <- data_210106[-2,]
data_210106 <- data_210106[-1,]

data_210106$row_number <- seq(1, by=1, length.out=nrow(data_210106))
```


```{r}
data_210106####data_210106)/10000, length.out=nrow(data_210106))

ggplot(data_210106, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210106"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```

```{r}
trend_210106 <- loess(data_210106$Ba_DIV_Ca ~ data_210106$Elapsed_DIV_Time)
trend1_210106 <- data.frame(trend_210106 = trend_210106$fitted, Elapsed_DIV_Time = data_210106$Elapsed_DIV_Time)

ggplot(data_210106, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_210106, aes(y= trend_210106), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210106",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

```{r}
# subtracting the trend
data_210106$no_trend <- data_210106$Ba_DIV_Ca - trend1_210106$trend_210106

# dividing the new timeseries with the sd(timeserie)
data_210106$nt_sd <- data_210106$no_trend/sd(data_210106$no_trend)

# see if they oscillate around 0
ggplot(data_210106, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210106",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_210106, "data_210106.csv", row.names = FALSE)
```

# ############################### 210110 ####################################
```{r}
data_210110 <-merged_data_NEW %>%
  filter(whale_index == "SMP_210110") %>%
  select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_210110$row_number <- seq(1, by=1, length.out=nrow(data_210110))

subset(data_210110, Ba_DIV_Ca > 0.00003)
subset(data_210110, Ba_DIV_Ca < 0.00)
```

```{r}
data_210110$Ba_DIV_Ca[701] <- (data_210110$Ba_DIV_Ca[700] + data_210110$Ba_DIV_Ca[702]) / 2


data_210110 <- data_210110[-1810,]
data_210110 <- data_210110[-1809,]
data_210110 <- data_210110[-1808,]
data_210110 <- data_210110[-2,]
data_210110 <- data_210110[-1,]

data_210110$row_number <- seq(1, by=1, length.out=nrow(data_210110))
```


```{r}
data_210110####data_210110)/10000, length.out=nrow(data_210110))

ggplot(data_210110, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210110"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```

```{r}
trend_210110 <- loess(data_210110$Ba_DIV_Ca ~ data_210110$Elapsed_DIV_Time)
trend1_210110 <- data.frame(trend_210110 = trend_210110$fitted, Elapsed_DIV_Time = data_210110$Elapsed_DIV_Time)

ggplot(data_210110, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_210110, aes(y= trend_210110), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210110",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

```{r}
# subtracting the trend
data_210110$no_trend <- data_210110$Ba_DIV_Ca - trend1_210110$trend_210110

# dividing the new timeseries with the sd(timeserie)
data_210110$nt_sd <- data_210110$no_trend/sd(data_210110$no_trend)

# see if they oscillate around 0
ggplot(data_210110, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210110",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_210110, "data_210110.csv", row.names = FALSE)
```

# ############################### 210111 ####################################
```{r}
data_210111 <-merged_data_NEW %>%
  filter(whale_index == "SMP_210111") %>%
  select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_210111$row_number <- seq(1, by=1, length.out=nrow(data_210111))

subset(data_210111, Ba_DIV_Ca > 0.002)
subset(data_210111, Ba_DIV_Ca < 0.00)
```

```{r}
data_210111 <- data_210111[-1700,]
data_210111 <- data_210111[-1699,]
data_210111 <- data_210111[-1698,]
data_210111 <- data_210111[-1697,]
data_210111 <- data_210111[-1696,]

data_210111 <- data_210111[-3,]
data_210111 <- data_210111[-2,]
data_210111 <- data_210111[-1,]


data_210111$row_number <- seq(1, by=1, length.out=nrow(data_210111))
```


```{r}
data_210111####data_210111)/10000, length.out=nrow(data_210111))

ggplot(data_210111, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210111"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```

```{r}
trend_210111 <- loess(data_210111$Ba_DIV_Ca ~ data_210111$Elapsed_DIV_Time)
trend1_210111 <- data.frame(trend_210111 = trend_210111$fitted, Elapsed_DIV_Time = data_210111$Elapsed_DIV_Time)

ggplot(data_210111, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_210111, aes(y= trend_210111), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210111",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

```{r}
# subtracting the trend
data_210111$no_trend <- data_210111$Ba_DIV_Ca - trend1_210111$trend_210111

# dividing the new timeseries with the sd(timeserie)
data_210111$nt_sd <- data_210111$no_trend/sd(data_210111$no_trend)

# see if they oscillate around 0
ggplot(data_210111, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210111",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_210111, "data_210111.csv", row.names = FALSE)
```

# ############################### 210113 ####################################
```{r}
data_210113 <-merged_data_NEW %>%
  filter(whale_index == "SMP_210113") %>%
  select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_210113$row_number <- seq(1, by=1, length.out=nrow(data_210113))

subset(data_210113, Ba_DIV_Ca > 0.000012)
subset(data_210113, Ba_DIV_Ca < 0.00)
```

```{r}
data_210113$Ba_DIV_Ca[1221] <- (data_210113$Ba_DIV_Ca[1222] + data_210113$Ba_DIV_Ca[1220]) / 2
data_210113$Ba_DIV_Ca[1418] <- (data_210113$Ba_DIV_Ca[1419] + data_210113$Ba_DIV_Ca[1417]) / 2
data_210113$Ba_DIV_Ca[929] <- (data_210113$Ba_DIV_Ca[928] + data_210113$Ba_DIV_Ca[930]) / 2
data_210113$Ba_DIV_Ca[573] <- (data_210113$Ba_DIV_Ca[572] + data_210113$Ba_DIV_Ca[574]) / 2

data_210113 <- data_210113[-c(1462:1467),]
data_210113 <- data_210113[-c(1:3),]

data_210113$row_number <- seq(1, by=1, length.out=nrow(data_210113))
```


```{r}
data_210113####data_210113)/10000, length.out=nrow(data_210113))

ggplot(data_210113, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210113"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```

```{r}
trend_210113 <- loess(data_210113$Ba_DIV_Ca ~ data_210113$Elapsed_DIV_Time)
trend1_210113 <- data.frame(trend_210113 = trend_210113$fitted, Elapsed_DIV_Time = data_210113$Elapsed_DIV_Time)

ggplot(data_210113, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_210113, aes(y= trend_210113), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210113",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

```{r}
# subtracting the trend
data_210113$no_trend <- data_210113$Ba_DIV_Ca - trend1_210113$trend_210113

# dividing the new timeseries with the sd(timeserie)
data_210113$nt_sd <- data_210113$no_trend/sd(data_210113$no_trend)

# see if they oscillate around 0
ggplot(data_210113, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210113",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_210113, "data_210113.csv", row.names = FALSE)
```

# ############################### 210114 ####################################
```{r}
data_210114 <-merged_data_NEW %>%
  filter(whale_index == "SMP_210114") %>%
  select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_210114$row_number <- seq(1, by=1, length.out=nrow(data_210114))

subset(data_210114, Ba_DIV_Ca > 0.000025)
subset(data_210114, Ba_DIV_Ca < 0.00)
```

```{r}
data_210114$Ba_DIV_Ca[854] <- (data_210114$Ba_DIV_Ca[853] + data_210114$Ba_DIV_Ca[855]) / 2


data_210114 <- data_210114[-1014,]
data_210114 <- data_210114[-1013,]
data_210114 <- data_210114[-1012,]
data_210114 <- data_210114[-1011,]
data_210114 <- data_210114[-2,]
data_210114 <- data_210114[-1,]

data_210114$row_number <- seq(1, by=1, length.out=nrow(data_210114))
```


```{r}
data_210114####data_210114)/10000, length.out=nrow(data_210114))

ggplot(data_210114, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210114"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```

```{r}
trend_210114 <- loess(data_210114$Ba_DIV_Ca ~ data_210114$Elapsed_DIV_Time)
trend1_210114 <- data.frame(trend_210114 = trend_210114$fitted, Elapsed_DIV_Time = data_210114$Elapsed_DIV_Time)

ggplot(data_210114, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_210114, aes(y= trend_210114), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210114",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

```{r}
# subtracting the trend
data_210114$no_trend <- data_210114$Ba_DIV_Ca - trend1_210114$trend_210114

# dividing the new timeseries with the sd(timeserie)
data_210114$nt_sd <- data_210114$no_trend/sd(data_210114$no_trend)

# see if they oscillate around 0
ggplot(data_210114, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210114",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_210114, "data_210114.csv", row.names = FALSE)
```

# ############################### 210122 ####################################
```{r}
data_210122 <-merged_data_NEW %>%
  filter(whale_index == "SMP_210122") %>%
  select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_210122$row_number <- seq(1, by=1, length.out=nrow(data_210122))

subset(data_210122, Ba_DIV_Ca > 0.00004)
subset(data_210122, Ba_DIV_Ca < 0.00)
```

```{r}
data_210122$Ba_DIV_Ca[309] <- (data_210122$Ba_DIV_Ca[310] + data_210122$Ba_DIV_Ca[308]) / 2
data_210122$Ba_DIV_Ca[672] <- (data_210122$Ba_DIV_Ca[671] + data_210122$Ba_DIV_Ca[673]) / 2
data_210122$Ba_DIV_Ca[704] <- (data_210122$Ba_DIV_Ca[705] + data_210122$Ba_DIV_Ca[703]) / 2
data_210122$Ba_DIV_Ca[750] <- (data_210122$Ba_DIV_Ca[749] + data_210122$Ba_DIV_Ca[751]) / 2
data_210122$Ba_DIV_Ca[965] <- (data_210122$Ba_DIV_Ca[966] + data_210122$Ba_DIV_Ca[964]) / 2
data_210122$Ba_DIV_Ca[946] <- (data_210122$Ba_DIV_Ca[945] + data_210122$Ba_DIV_Ca[947]) / 2
data_210122$Ba_DIV_Ca[1431] <- (data_210122$Ba_DIV_Ca[1430] + data_210122$Ba_DIV_Ca[1432]) / 2
data_210122$Ba_DIV_Ca[1437] <- (data_210122$Ba_DIV_Ca[1438] + data_210122$Ba_DIV_Ca[1436]) / 2
data_210122$Ba_DIV_Ca[1456] <- (data_210122$Ba_DIV_Ca[1457] + data_210122$Ba_DIV_Ca[1455]) / 2

data_210122$Ba_DIV_Ca[1420:1421] <- data_210122$Ba_DIV_Ca[1419] + 
  ((1:2) / 3) * (data_210122$Ba_DIV_Ca[1422] - data_210122$Ba_DIV_Ca[1419])

data_210122 <- data_210122[-c(1461:1463),]
data_210122 <- data_210122[-2,]
data_210122 <- data_210122[-1,]

data_210122$row_number <- seq(1, by=1, length.out=nrow(data_210122))
```


```{r}
data_210122####data_210122)/10000, length.out=nrow(data_210122))

ggplot(data_210122, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210122"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```

```{r}
trend_210122 <- loess(data_210122$Ba_DIV_Ca ~ data_210122$Elapsed_DIV_Time)
trend1_210122 <- data.frame(trend_210122 = trend_210122$fitted, Elapsed_DIV_Time = data_210122$Elapsed_DIV_Time)

ggplot(data_210122, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_210122, aes(y= trend_210122), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210122",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

```{r}
# subtracting the trend
data_210122$no_trend <- data_210122$Ba_DIV_Ca - trend1_210122$trend_210122

# dividing the new timeseries with the sd(timeserie)
data_210122$nt_sd <- data_210122$no_trend/sd(data_210122$no_trend)

# see if they oscillate around 0
ggplot(data_210122, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210122",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_210122, "data_210122.csv", row.names = FALSE)
```

# ############################### 210124 ####################################
```{r}
data_210124 <-merged_data_NEW %>%
  filter(whale_index == "SMP_210124") %>%
  select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_210124$row_number <- seq(1, by=1, length.out=nrow(data_210124))

subset(data_210124, Ba_DIV_Ca > 0.00003)
subset(data_210124, Ba_DIV_Ca < 0.00)
```

```{r}
data_210124$Ba_DIV_Ca[358] <- (data_210124$Ba_DIV_Ca[357] + data_210124$Ba_DIV_Ca[359]) / 2
data_210124$Ba_DIV_Ca[1163] <- (data_210124$Ba_DIV_Ca[1162] + data_210124$Ba_DIV_Ca[1164]) / 2
data_210124$Ba_DIV_Ca[1259] <- (data_210124$Ba_DIV_Ca[1260] + data_210124$Ba_DIV_Ca[1258]) / 2
data_210124$Ba_DIV_Ca[1261] <- (data_210124$Ba_DIV_Ca[1260] + data_210124$Ba_DIV_Ca[1262]) / 2


data_210124 <- data_210124[-2020,]
data_210124 <- data_210124[-2019,]
data_210124 <- data_210124[-2018,]
data_210124 <- data_210124[-c(1:3),]

data_210124$row_number <- seq(1, by=1, length.out=nrow(data_210124))
```


```{r}
data_210124####data_210124)/10000, length.out=nrow(data_210124))

ggplot(data_210124, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210124"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```

```{r}
trend_210124 <- loess(data_210124$Ba_DIV_Ca ~ data_210124$Elapsed_DIV_Time)
trend1_210124 <- data.frame(trend_210124 = trend_210124$fitted, Elapsed_DIV_Time = data_210124$Elapsed_DIV_Time)

ggplot(data_210124, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_210124, aes(y= trend_210124), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210124",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

```{r}
# subtracting the trend
data_210124$no_trend <- data_210124$Ba_DIV_Ca - trend1_210124$trend_210124

# dividing the new timeseries with the sd(timeserie)
data_210124$nt_sd <- data_210124$no_trend/sd(data_210124$no_trend)

# see if they oscillate around 0
ggplot(data_210124, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210124",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_210124, "data_210124.csv", row.names = FALSE)
```

# ############################### 210125 ####################################
```{r}
data_210125 <-merged_data_NEW %>%
  filter(whale_index == "SMP_210125") %>%
  select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_210125$row_number <- seq(1, by=1, length.out=nrow(data_210125))

subset(data_210125, Ba_DIV_Ca > 0.00001)
subset(data_210125, Ba_DIV_Ca < 0.00)
```

```{r}
data_210125$Ba_DIV_Ca[1851]    <- (data_210125$Ba_DIV_Ca[1850] + data_210125$Ba_DIV_Ca[1852]) / 2
data_210125$Ba_DIV_Ca[1150]    <- (data_210125$Ba_DIV_Ca[1149] + data_210125$Ba_DIV_Ca[1151]) / 2
data_210125$Ba_DIV_Ca[633]    <- (data_210125$Ba_DIV_Ca[632] + data_210125$Ba_DIV_Ca[634]) / 2


data_210125 <- data_210125[-c(1864:1867),]
data_210125 <- data_210125[-c(1:9),]

data_210125$row_number <- seq(1, by=1, length.out=nrow(data_210125))
```


```{r}
data_210125####data_210125)/10000, length.out=nrow(data_210125))

ggplot(data_210125, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210125"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```

```{r}
trend_210125 <- loess(data_210125$Ba_DIV_Ca ~ data_210125$Elapsed_DIV_Time)
trend1_210125 <- data.frame(trend_210125 = trend_210125$fitted, Elapsed_DIV_Time = data_210125$Elapsed_DIV_Time)

ggplot(data_210125, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_210125, aes(y= trend_210125), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210125",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

```{r}
# subtracting the trend
data_210125$no_trend <- data_210125$Ba_DIV_Ca - trend1_210125$trend_210125

# dividing the new timeseries with the sd(timeserie)
data_210125$nt_sd <- data_210125$no_trend/sd(data_210125$no_trend)

# see if they oscillate around 0
ggplot(data_210125, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210125",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_210125, "data_210125.csv", row.names = FALSE)
```

# ############################### 210127 ####################################
```{r}
data_210127 <-merged_data_NEW %>%
  filter(whale_index == "SMP_210127") %>%
  select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_210127$row_number <- seq(1, by=1, length.out=nrow(data_210127))

subset(data_210127, Ba_DIV_Ca > 0.000016)
subset(data_210127, Ba_DIV_Ca < 0.00)
```

```{r}
data_210127$Ba_DIV_Ca[1014] <- (data_210127$Ba_DIV_Ca[1013] + data_210127$Ba_DIV_Ca[1015]) / 2
data_210127$Ba_DIV_Ca[1640] <- (data_210127$Ba_DIV_Ca[1641] + data_210127$Ba_DIV_Ca[1639]) / 2
data_210127$Ba_DIV_Ca[1549] <- (data_210127$Ba_DIV_Ca[1550] + data_210127$Ba_DIV_Ca[1548]) / 2
data_210127$Ba_DIV_Ca[90] <- (data_210127$Ba_DIV_Ca[91] + data_210127$Ba_DIV_Ca[89]) / 2

data_210127 <- data_210127[-1651,]
data_210127 <- data_210127[-c(1:4),]

data_210127$row_number <- seq(1, by=1, length.out=nrow(data_210127))
```


```{r}
data_210127####data_210127)/10000, length.out=nrow(data_210127))

ggplot(data_210127, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210127"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```

```{r}
trend_210127 <- loess(data_210127$Ba_DIV_Ca ~ data_210127$Elapsed_DIV_Time)
trend1_210127 <- data.frame(trend_210127 = trend_210127$fitted, Elapsed_DIV_Time = data_210127$Elapsed_DIV_Time)

ggplot(data_210127, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_210127, aes(y= trend_210127), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210127",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

```{r}
# subtracting the trend
data_210127$no_trend <- data_210127$Ba_DIV_Ca - trend1_210127$trend_210127

# dividing the new timeseries with the sd(timeserie)
data_210127$nt_sd <- data_210127$no_trend/sd(data_210127$no_trend)

# see if they oscillate around 0
ggplot(data_210127, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210127",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_210127, "data_210127.csv", row.names = FALSE)
```

# ############################### 210129 ####################################
```{r}
data_210129 <-merged_data_NEW %>%
  filter(whale_index == "SMP_210129") %>%
  select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_210129$row_number <- seq(1, by=1, length.out=nrow(data_210129))

subset(data_210129, Ba_DIV_Ca > 0.000015)
subset(data_210129, Ba_DIV_Ca < 0.00)
```

```{r}
data_210129$Ba_DIV_Ca[260]    <- (data_210129$Ba_DIV_Ca[261] + data_210129$Ba_DIV_Ca[259]) / 2
data_210129$Ba_DIV_Ca[1381]    <- (data_210129$Ba_DIV_Ca[1380] + data_210129$Ba_DIV_Ca[1382]) / 2

data_210129 <- data_210129[-c(1502:1504),]
data_210129 <- data_210129[-c(1:3),]

data_210129$row_number <- seq(1, by=1, length.out=nrow(data_210129))
```


```{r}
data_210129####data_210129)/10000, length.out=nrow(data_210129))

ggplot(data_210129, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210129"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```

```{r}
trend_210129 <- loess(data_210129$Ba_DIV_Ca ~ data_210129$Elapsed_DIV_Time)
trend1_210129 <- data.frame(trend_210129 = trend_210129$fitted, Elapsed_DIV_Time = data_210129$Elapsed_DIV_Time)

ggplot(data_210129, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_210129, aes(y= trend_210129), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210129",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

```{r}
# subtracting the trend
data_210129$no_trend <- data_210129$Ba_DIV_Ca - trend1_210129$trend_210129

# dividing the new timeseries with the sd(timeserie)
data_210129$nt_sd <- data_210129$no_trend/sd(data_210129$no_trend)

# see if they oscillate around 0
ggplot(data_210129, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210129",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_210129, "data_210129.csv", row.names = FALSE)
```


# ############################### 210149 ####################################
```{r}
data_210149 <-merged_data_NEW %>%
  filter(whale_index == "SMP_210149") %>%
  select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_210149$row_number <- seq(1, by=1, length.out=nrow(data_210149))

subset(data_210149, Ba_DIV_Ca > 0.000015)
subset(data_210149, Ba_DIV_Ca < 0.00)
```

```{r}
data_210149$Ba_DIV_Ca[405] <- (data_210149$Ba_DIV_Ca[404] + data_210149$Ba_DIV_Ca[406]) / 2

data_210149 <- data_210149[-c(1730:1734),]
data_210149 <- data_210149[-c(1:3),]

data_210149$row_number <- seq(1, by=1, length.out=nrow(data_210149))
```


```{r}
data_210149####data_210149)/10000, length.out=nrow(data_210149))

ggplot(data_210149, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210149"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```

```{r}
trend_210149 <- loess(data_210149$Ba_DIV_Ca ~ data_210149$Elapsed_DIV_Time)
trend1_210149 <- data.frame(trend_210149 = trend_210149$fitted, Elapsed_DIV_Time = data_210149$Elapsed_DIV_Time)

ggplot(data_210149, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_210149, aes(y= trend_210149), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210149",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

```{r}
# subtracting the trend
data_210149$no_trend <- data_210149$Ba_DIV_Ca - trend1_210149$trend_210149

# dividing the new timeseries with the sd(timeserie)
data_210149$nt_sd <- data_210149$no_trend/sd(data_210149$no_trend)

# see if they oscillate around 0
ggplot(data_210149, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210149",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_210149, "data_210149.csv", row.names = FALSE)
```

# ############################### 210151 ####################################
```{r}
data_210151 <-merged_data_NEW %>%
  filter(whale_index == "SMP_210151") %>%
  select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_210151$row_number <- seq(1, by=1, length.out=nrow(data_210151))

subset(data_210151, Ba_DIV_Ca > 0.00004)
subset(data_210151, Ba_DIV_Ca < 0.00)
```

```{r}
data_210151$Ba_DIV_Ca[1213] <- (data_210151$Ba_DIV_Ca[1214] + data_210151$Ba_DIV_Ca[1212]) / 2

data_210151 <- data_210151[-c(1602:1606),]
data_210151 <- data_210151[-c(1:3),]

data_210151$row_number <- seq(1, by=1, length.out=nrow(data_210151))
```


```{r}
data_210151####data_210151)/10000, length.out=nrow(data_210151))

ggplot(data_210151, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210151"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```

```{r}
trend_210151 <- loess(data_210151$Ba_DIV_Ca ~ data_210151$Elapsed_DIV_Time)
trend1_210151 <- data.frame(trend_210151 = trend_210151$fitted, Elapsed_DIV_Time = data_210151$Elapsed_DIV_Time)

ggplot(data_210151, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_210151, aes(y= trend_210151), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210151",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

```{r}
# subtracting the trend
data_210151$no_trend <- data_210151$Ba_DIV_Ca - trend1_210151$trend_210151

# dividing the new timeseries with the sd(timeserie)
data_210151$nt_sd <- data_210151$no_trend/sd(data_210151$no_trend)

# see if they oscillate around 0
ggplot(data_210151, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210151",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_210151, "data_210151.csv", row.names = FALSE)
```

# ############################### 210160 ####################################
```{r}
data_210160 <-merged_data_NEW %>%
  filter(whale_index == "SMP_210160") %>%
  select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_210160$row_number <- seq(1, by=1, length.out=nrow(data_210160))

subset(data_210160, Ba_DIV_Ca > 0.00001)
subset(data_210160, Ba_DIV_Ca < 0.000)
```

```{r}
data_210160$Ba_DIV_Ca[1330] <- (data_210160$Ba_DIV_Ca[1331] + data_210160$Ba_DIV_Ca[1329]) / 2

data_210160 <- data_210160[-c(1785:1790),]
data_210160 <- data_210160[-2,]
data_210160 <- data_210160[-1,]

data_210160$row_number <- seq(1, by=1, length.out=nrow(data_210160))
```


```{r}
data_210160####data_210160)/10000, length.out=nrow(data_210160))

ggplot(data_210160, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210160"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```

```{r}
trend_210160 <- loess(data_210160$Ba_DIV_Ca ~ data_210160$Elapsed_DIV_Time)
trend1_210160 <- data.frame(trend_210160 = trend_210160$fitted, Elapsed_DIV_Time = data_210160$Elapsed_DIV_Time)

ggplot(data_210160, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_210160, aes(y= trend_210160), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210160",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

```{r}
# subtracting the trend
data_210160$no_trend <- data_210160$Ba_DIV_Ca - trend1_210160$trend_210160

# dividing the new timeseries with the sd(timeserie)
data_210160$nt_sd <- data_210160$no_trend/sd(data_210160$no_trend)

# see if they oscillate around 0
ggplot(data_210160, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210160",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_210160, "data_210160.csv", row.names = FALSE)
```

# ############################### 210161 ####################################
```{r}
data_210161 <-merged_data_NEW %>%
  filter(whale_index == "SMP_210161") %>%
  select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_210161$row_number <- seq(1, by=1, length.out=nrow(data_210161))

subset(data_210161, Ba_DIV_Ca > 0.000025)
subset(data_210161, Ba_DIV_Ca < 0.00)
```

```{r}
data_210161$Ba_DIV_Ca[950] <- (data_210161$Ba_DIV_Ca[951] + data_210161$Ba_DIV_Ca[949]) / 2
data_210161$Ba_DIV_Ca[1506] <- (data_210161$Ba_DIV_Ca[1505] + data_210161$Ba_DIV_Ca[1507]) / 2
data_210161$Ba_DIV_Ca[1072] <- (data_210161$Ba_DIV_Ca[1073] + data_210161$Ba_DIV_Ca[1071]) / 2
data_210161$Ba_DIV_Ca[1112] <- (data_210161$Ba_DIV_Ca[1113] + data_210161$Ba_DIV_Ca[1111]) / 2


data_210161 <- data_210161[-c(1742:1746),]
data_210161 <- data_210161[-c(1:3),]

data_210161$row_number <- seq(1, by=1, length.out=nrow(data_210161))
```


```{r}
data_210161####data_210161)/10000, length.out=nrow(data_210161))

ggplot(data_210161, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210161"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```

```{r}
trend_210161 <- loess(data_210161$Ba_DIV_Ca ~ data_210161$Elapsed_DIV_Time)
trend1_210161 <- data.frame(trend_210161 = trend_210161$fitted, Elapsed_DIV_Time = data_210161$Elapsed_DIV_Time)

ggplot(data_210161, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_210161, aes(y= trend_210161), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210161",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

```{r}
# subtracting the trend
data_210161$no_trend <- data_210161$Ba_DIV_Ca - trend1_210161$trend_210161

# dividing the new timeseries with the sd(timeserie)
data_210161$nt_sd <- data_210161$no_trend/sd(data_210161$no_trend)

# see if they oscillate around 0
ggplot(data_210161, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210161",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_210161, "data_210161.csv", row.names = FALSE)
```

# ############################### 210163 ####################################
```{r}
data_210163 <-merged_data_NEW %>%
  filter(whale_index == "SMP_210163") %>%
  select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_210163$row_number <- seq(1, by=1, length.out=nrow(data_210163))

subset(data_210163, Ba_DIV_Ca > 0.00005)
subset(data_210163, Ba_DIV_Ca < 0.00)
```

```{r}
data_210163$Ba_DIV_Ca[978:986] <- data_210163$Ba_DIV_Ca[977] + 
  ((1:9) / 10) * (data_210163$Ba_DIV_Ca[987] - data_210163$Ba_DIV_Ca[977])

data_210163$Ba_DIV_Ca[1080:1082] <- data_210163$Ba_DIV_Ca[1079] + 
  ((1:3) / 4) * (data_210163$Ba_DIV_Ca[1083] - data_210163$Ba_DIV_Ca[1079])

data_210163$Ba_DIV_Ca[1212] <- (data_210163$Ba_DIV_Ca[1211] + data_210163$Ba_DIV_Ca[1213]) / 2


data_210163 <- data_210163[-c(1551:1553),]
data_210163 <- data_210163[-2,]
data_210163 <- data_210163[-1,]

data_210163$row_number <- seq(1, by=1, length.out=nrow(data_210163))
```


```{r}
data_210163####data_210163)/10000, length.out=nrow(data_210163))

ggplot(data_210163, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210163"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```

```{r}
trend_210163 <- loess(data_210163$Ba_DIV_Ca ~ data_210163$Elapsed_DIV_Time)
trend1_210163 <- data.frame(trend_210163 = trend_210163$fitted, Elapsed_DIV_Time = data_210163$Elapsed_DIV_Time)

ggplot(data_210163, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_210163, aes(y= trend_210163), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210163",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

```{r}
# subtracting the trend
data_210163$no_trend <- data_210163$Ba_DIV_Ca - trend1_210163$trend_210163

# dividing the new timeseries with the sd(timeserie)
data_210163$nt_sd <- data_210163$no_trend/sd(data_210163$no_trend)

# see if they oscillate around 0
ggplot(data_210163, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210163",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_210163, "data_210163.csv", row.names = FALSE)
```

# ############################### 210169 ####################################
```{r}
data_210169 <-merged_data_NEW %>%
  filter(whale_index == "SMP_210169") %>%
  select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_210169$row_number <- seq(1, by=1, length.out=nrow(data_210169))

subset(data_210169, Ba_DIV_Ca > 0.00003)
subset(data_210169, Ba_DIV_Ca < 0.00)
```

```{r}
data_210169$Ba_DIV_Ca[7] <- (data_210169$Ba_DIV_Ca[8] + data_210169$Ba_DIV_Ca[6]) / 2

data_210169 <- data_210169[-c(1417:1419),]
data_210169 <- data_210169[-c(1:3),]

data_210169$row_number <- seq(1, by=1, length.out=nrow(data_210169))
```


```{r}
data_210169####data_210169)/10000, length.out=nrow(data_210169))

ggplot(data_210169, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210169"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```

```{r}
trend_210169 <- loess(data_210169$Ba_DIV_Ca ~ data_210169$Elapsed_DIV_Time)
trend1_210169 <- data.frame(trend_210169 = trend_210169$fitted, Elapsed_DIV_Time = data_210169$Elapsed_DIV_Time)

ggplot(data_210169, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_210169, aes(y= trend_210169), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210169",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

```{r}
# subtracting the trend
data_210169$no_trend <- data_210169$Ba_DIV_Ca - trend1_210169$trend_210169

# dividing the new timeseries with the sd(timeserie)
data_210169$nt_sd <- data_210169$no_trend/sd(data_210169$no_trend)

# see if they oscillate around 0
ggplot(data_210169, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210169",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_210169, "data_210169.csv", row.names = FALSE)
```

# ############################### 210172 ####################################
```{r}
data_210172 <-merged_data_NEW %>%
  filter(whale_index == "SMP_210172") %>%
  select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_210172$row_number <- seq(1, by=1, length.out=nrow(data_210172))

subset(data_210172, Ba_DIV_Ca > 0.00005)
subset(data_210172, Ba_DIV_Ca < 0.00)
```

```{r}
data_210172$Ba_DIV_Ca[732] <- (data_210172$Ba_DIV_Ca[733] + data_210172$Ba_DIV_Ca[731]) / 2
data_210172$Ba_DIV_Ca[952] <- (data_210172$Ba_DIV_Ca[953] + data_210172$Ba_DIV_Ca[951]) / 2
data_210172$Ba_DIV_Ca[956] <- (data_210172$Ba_DIV_Ca[955] + data_210172$Ba_DIV_Ca[957]) / 2

data_210172 <- data_210172[-c(954:956),]
data_210172 <- data_210172[-c(1:6),]

data_210172$row_number <- seq(1, by=1, length.out=nrow(data_210172))
```


```{r}
data_210172####data_210172)/10000, length.out=nrow(data_210172))

ggplot(data_210172, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210172"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```

```{r}
trend_210172 <- loess(data_210172$Ba_DIV_Ca ~ data_210172$Elapsed_DIV_Time)
trend1_210172 <- data.frame(trend_210172 = trend_210172$fitted, Elapsed_DIV_Time = data_210172$Elapsed_DIV_Time)

ggplot(data_210172, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_210172, aes(y= trend_210172), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210172",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

```{r}
# subtracting the trend
data_210172$no_trend <- data_210172$Ba_DIV_Ca - trend1_210172$trend_210172

# dividing the new timeseries with the sd(timeserie)
data_210172$nt_sd <- data_210172$no_trend/sd(data_210172$no_trend)

# see if they oscillate around 0
ggplot(data_210172, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210172",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_210172, "data_210172.csv", row.names = FALSE)
```

# ############################### 210174 ####################################
```{r}
data_210174 <-merged_data_NEW %>%
  filter(whale_index == "SMP_210174") %>%
  select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_210174$row_number <- seq(1, by=1, length.out=nrow(data_210174))

subset(data_210174, Ba_DIV_Ca > 0.000015)
subset(data_210174, Ba_DIV_Ca < 0.00)
```

```{r}
data_210174$Ba_DIV_Ca[655] <- (data_210174$Ba_DIV_Ca[654] + data_210174$Ba_DIV_Ca[656]) / 2
data_210174$Ba_DIV_Ca[736] <- (data_210174$Ba_DIV_Ca[737] + data_210174$Ba_DIV_Ca[735]) / 2
data_210174$Ba_DIV_Ca[1248] <- (data_210174$Ba_DIV_Ca[1249] + data_210174$Ba_DIV_Ca[1247]) / 2

data_210174 <- data_210174[-c(2263:2269),]

data_210174 <- data_210174[-2,]
data_210174 <- data_210174[-1,]

data_210174$row_number <- seq(1, by=1, length.out=nrow(data_210174))
```


```{r}
data_210174####data_210174)/10000, length.out=nrow(data_210174))

ggplot(data_210174, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210174"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```

```{r}
trend_210174 <- loess(data_210174$Ba_DIV_Ca ~ data_210174$Elapsed_DIV_Time)
trend1_210174 <- data.frame(trend_210174 = trend_210174$fitted, Elapsed_DIV_Time = data_210174$Elapsed_DIV_Time)

ggplot(data_210174, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_210174, aes(y= trend_210174), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210174",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

```{r}
# subtracting the trend
data_210174$no_trend <- data_210174$Ba_DIV_Ca - trend1_210174$trend_210174

# dividing the new timeseries with the sd(timeserie)
data_210174$nt_sd <- data_210174$no_trend/sd(data_210174$no_trend)

# see if they oscillate around 0
ggplot(data_210174, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_210174",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_210174, "data_210174.csv", row.names = FALSE)
```

# ############################### 510158 ####################################
```{r}
data_510158 <-merged_data_NEW %>%
  filter(whale_index == "SMP_510158") %>%
  select(whale_index, Elapsed_DIV_Time, Ba_DIV_Ca)

data_510158$row_number <- seq(1, by=1, length.out=nrow(data_510158))

subset(data_510158, Ba_DIV_Ca > 0.00002)
subset(data_510158, Ba_DIV_Ca < 0.00)
```

```{r}
data_510158$Ba_DIV_Ca[479] <- (data_510158$Ba_DIV_Ca[480] + data_510158$Ba_DIV_Ca[478]) / 2
data_510158$Ba_DIV_Ca[1738] <- (data_510158$Ba_DIV_Ca[1739] + data_510158$Ba_DIV_Ca[1737]) / 2

data_510158 <- data_510158[-c(2025:2026),]
data_510158 <- data_510158[-c(1:4),]

data_510158$row_number <- seq(1, by=1, length.out=nrow(data_510158))
```


```{r}
data_510158####data_510158)/10000, length.out=nrow(data_510158))

ggplot(data_510158, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_point() +
  labs(title = paste("Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_510158"),
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_bw()
```

```{r}
trend_510158 <- loess(data_510158$Ba_DIV_Ca ~ data_510158$Elapsed_DIV_Time)
trend1_510158 <- data.frame(trend_510158 = trend_510158$fitted, Elapsed_DIV_Time = data_510158$Elapsed_DIV_Time)

ggplot(data_510158, aes(x = Elapsed_DIV_Time, y = Ba_DIV_Ca)) +
  geom_line() +
  geom_line(data = trend1_510158, aes(y= trend_510158), color = "blue") +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_510158",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()
```

```{r}
# subtracting the trend
data_510158$no_trend <- data_510158$Ba_DIV_Ca - trend1_510158$trend_510158

# dividing the new timeseries with the sd(timeserie)
data_510158$nt_sd <- data_510158$no_trend/sd(data_510158$no_trend)

# see if they oscillate around 0
ggplot(data_510158, aes(x = Elapsed_DIV_Time, y = nt_sd)) +
  geom_line() +
  labs(title = "Ba_DIV_Ca vs Elapsed_DIV_Time for SMP_510158",
       x = "Elapsed_DIV_Time",
       y = "Ba_DIV_Ca") +
  theme_minimal()

# Exporting
write.csv(data_510158, "data_510158.csv", row.names = FALSE)
```


